<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - ShoppaMall</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #0f172a;
            --darker: #020617;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text: #f8fafc;
            --text-secondary: #94a3b8;
        }

        body {
            background: linear-gradient(135deg, var(--darker), #1e1b4b, var(--dark));
            color: var(--text);
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(239, 68, 68, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(245, 158, 11, 0.05) 0%, transparent 50%);
            z-index: -1;
        }

        .glass {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            width: 100%;
            max-width: 400px;
            padding: 40px 30px;
            text-align: center;
        }

        .admin-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 30px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            font-weight: bold;
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3);
        }

        .login-title {
            font-size: 24px;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text);
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--secondary), #059669);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #d97706);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
        }

        /* Admin Panel */
        .admin-container {
            display: none;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            margin-bottom: 20px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .nav-btn {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-color: var(--primary);
        }

        .admin-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .admin-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            padding: 20px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .data-table th,
        .data-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--glass-border);
        }

        .data-table th {
            color: var(--text-secondary);
            font-weight: 600;
            background: rgba(255, 255, 255, 0.05);
        }

        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .status-success {
            background: rgba(16, 185, 129, 0.2);
            color: var(--secondary);
        }

        .status-failed {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .notification-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        /* Bot Controls */
        .bot-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .bot-card {
            padding: 20px;
        }

        .bot-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 15px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background: var(--text-secondary);
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background: linear-gradient(135deg, var(--secondary), #059669);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
            background: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--glass-border);
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text);
            font-size: 24px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }

        .close-modal:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .user-detail {
            padding: 20px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--glass-border);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        /* Settings controls */
        input[type="range"] {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        select.form-control {
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid var(--glass-border);
            color: var(--text);
            padding: 12px 16px;
            border-radius: 8px;
            width: 100%;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-nav {
                flex-wrap: wrap;
            }
            
            .bot-controls {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Admin Login -->
    <div class="login-container">
        <div class="login-card glass">
            <div class="admin-logo">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h1 class="login-title">Admin Panel</h1>
            <p style="color: var(--text-secondary); margin-bottom: 30px; font-size: 14px;">
                ShoppaMall - Qu·∫£n tr·ªã h·ªá th·ªëng
            </p>
            
            <div id="admin-login">
                <div class="form-group">
                    <label for="admin-username">T√™n ƒëƒÉng nh·∫≠p</label>
                    <input type="text" id="admin-username" class="form-control" placeholder="Nh·∫≠p t√™n admin">
                </div>
                <div class="form-group">
                    <label for="admin-password">M·∫≠t kh·∫©u</label>
                    <input type="password" id="admin-password" class="form-control" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                </div>
                <button type="button" class="btn btn-primary" onclick="adminLogin(); return false;">
                    <i class="fas fa-sign-in-alt"></i> ƒêƒÉng nh·∫≠p
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-container container">
        <div class="admin-header glass">
            <div class="header-left">
                <div style="font-size: 24px; font-weight: bold; color: var(--primary);">Admin Panel</div>
                <div style="font-size: 14px; color: var(--text-secondary);">ShoppaMall Management System</div>
            </div>
            <div>
                <button class="btn btn-danger" onclick="adminLogout()">
                    <i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t
                </button>
            </div>
        </div>

        <div class="admin-nav">
            <button class="nav-btn active" onclick="showAdminTab('dashboard')">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </button>
            <button class="nav-btn" onclick="showAdminTab('deposits')">
                <i class="fas fa-wallet"></i> Qu·∫£n l√Ω n·∫°p ti·ªÅn
            </button>
            <button class="nav-btn" onclick="showAdminTab('withdraws')">
                <i class="fas fa-money-bill-wave"></i> Qu·∫£n l√Ω r√∫t ti·ªÅn
            </button>
            <button class="nav-btn" onclick="showAdminTab('users')">
                <i class="fas fa-users"></i> Qu·∫£n l√Ω t√†i kho·∫£n
            </button>
            <button class="nav-btn" onclick="showAdminTab('notifications')">
                <i class="fas fa-bell"></i> Th√¥ng b√°o chung
            </button>
            <button class="nav-btn" onclick="showAdminTab('bots')">
                <i class="fas fa-robot"></i> Bot ƒëi·ªÅu khi·ªÉn
            </button>
            <button class="nav-btn" onclick="showAdminTab('admin-account')">
                <i class="fas fa-user-shield"></i> T√†i kho·∫£n Admin
            </button>
        </div>

        <!-- Dashboard -->
        <div id="dashboard-tab" class="admin-content active">
            <div class="stats-grid">
                <div class="stat-card glass">
                    <div class="stat-label">T·ªïng s·ªë d∆∞ h·ªá th·ªëng</div>
                    <div class="stat-value" id="total-system-balance">0 VNƒê</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">T·ªïng ti·ªÅn ng∆∞·ªùi d√πng ƒë√£ n·∫°p</div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-label">T·ªïng ng∆∞·ªùi d√πng</div>
                    <div class="stat-value" id="total-users">0</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">T√†i kho·∫£n ƒë√£ ƒëƒÉng k√Ω</div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-label">ƒêang ch·ªù x·ª≠ l√Ω</div>
                    <div class="stat-value" id="pending-requests">0</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Y√™u c·∫ßu n·∫°p/r√∫t ti·ªÅn</div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-label">Doanh thu h√¥m nay</div>
                    <div class="stat-value" id="today-revenue">0 VNƒê</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Ti·ªÅn n·∫°p trong ng√†y</div>
                </div>
            </div>

            <div class="glass" style="padding: 20px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px;">Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Th·ªùi gian</th>
                                <th>Ng∆∞·ªùi d√πng</th>
                                <th>Lo·∫°i</th>
                                <th>S·ªë ti·ªÅn</th>
                                <th>Tr·∫°ng th√°i</th>
                            </tr>
                        </thead>
                        <tbody id="recent-activity">
                            <!-- Recent activity will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Deposit Management -->
        <div id="deposits-tab" class="admin-content">
            <div class="glass" style="padding: 20px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px;">Qu·∫£n l√Ω n·∫°p ti·ªÅn</h3>
                <button class="btn btn-secondary" onclick="loadDeposits()" style="margin-bottom: 15px;">
                    <i class="fas fa-sync-alt"></i> T·∫£i l·∫°i danh s√°ch
                </button>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Th·ªùi gian</th>
                                <th>Ng∆∞·ªùi d√πng</th>
                                <th>S·ªë ti·ªÅn</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="deposits-list">
                            <!-- Deposits will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Withdraw Management -->
        <div id="withdraws-tab" class="admin-content">
            <div class="glass" style="padding: 20px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px;">Qu·∫£n l√Ω r√∫t ti·ªÅn</h3>
                <button class="btn btn-secondary" onclick="loadWithdraws()" style="margin-bottom: 15px;">
                    <i class="fas fa-sync-alt"></i> T·∫£i l·∫°i danh s√°ch
                </button>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Th·ªùi gian</th>
                                <th>Ng∆∞·ªùi d√πng</th>
                                <th>S·ªë ti·ªÅn</th>
                                <th>Ng√¢n h√†ng</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="withdraws-list">
                            <!-- Withdraws will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- User Management -->
        <div id="users-tab" class="admin-content">
            <div class="glass" style="padding: 20px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px;">Qu·∫£n l√Ω t√†i kho·∫£n</h3>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <input type="text" id="user-search" class="form-control" placeholder="T√¨m ki·∫øm ng∆∞·ªùi d√πng..." 
                           onkeyup="searchUsers()">
                    <button class="btn btn-primary" onclick="searchUsers()">
                        <i class="fas fa-search"></i> T√¨m ki·∫øm
                    </button>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>T√™n ƒëƒÉng nh·∫≠p</th>
                                <th>Ng√†y t·∫°o</th>
                                <th>S·ªë d∆∞</th>
                                <th>ƒê√£ n·∫°p</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="users-list">
                            <!-- Users will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Notifications -->
        <div id="notifications-tab" class="admin-content">
            <div class="glass" style="padding: 20px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px;">T·∫°o th√¥ng b√°o chung</h3>
                <div class="notification-form">
                    <div class="form-group">
                        <label for="notification-title">Ti√™u ƒë·ªÅ th√¥ng b√°o</label>
                        <input type="text" id="notification-title" class="form-control" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ">
                    </div>
                    <div class="form-group">
                        <label for="notification-content">N·ªôi dung th√¥ng b√°o</label>
                        <textarea id="notification-content" class="form-control" rows="5" 
                                  placeholder="Nh·∫≠p n·ªôi dung th√¥ng b√°o..."></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="sendNotification()">
                        <i class="fas fa-paper-plane"></i> G·ª≠i th√¥ng b√°o
                    </button>
                </div>
            </div>

            <div class="glass" style="padding: 20px;">
                <h3 style="margin-bottom: 15px;">L·ªãch s·ª≠ th√¥ng b√°o</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Th·ªùi gian</th>
                                <th>Ti√™u ƒë·ªÅ</th>
                                <th>N·ªôi dung</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="notifications-list">
                            <!-- Notifications will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Bot Controls -->
        <div id="bots-tab" class="admin-content">
            <div class="glass" style="padding: 20px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px;">ƒêi·ªÅu khi·ªÉn Bot</h3>
                
                <!-- Settings cho Bot -->
                <div style="margin-bottom: 30px;" class="glass" style="padding: 20px;">
                    <h4 style="margin-bottom: 15px;">‚öôÔ∏è C√†i ƒë·∫∑t Bot</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="form-group">
                            <label for="bot-frequency">T·∫ßn su·∫•t giao d·ªãch (gi√¢y)</label>
                            <input type="range" id="bot-frequency" min="5" max="60" value="15" class="form-control">
                            <div style="text-align: center; font-size: 12px; color: var(--text-secondary);">
                                <span id="frequency-value">15 gi√¢y</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="bot-transaction-count">S·ªë giao d·ªãch/ng√†y</label>
                            <input type="range" id="bot-transaction-count" min="10" max="500" value="100" class="form-control">
                            <div style="text-align: center; font-size: 12px; color: var(--text-secondary);">
                                <span id="transaction-count-value">100 giao d·ªãch</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="bot-max-amount">S·ªë ti·ªÅn t·ªëi ƒëa</label>
                            <select id="bot-max-amount" class="form-control">
                                <option value="1000000">1 Tri·ªáu VNƒê</option>
                                <option value="5000000">5 Tri·ªáu VNƒê</option>
                                <option value="10000000" selected>10 Tri·ªáu VNƒê</option>
                                <option value="50000000">50 Tri·ªáu VNƒê</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="bot-controls">
                    <div class="bot-card glass">
                        <h4 style="margin-bottom: 10px;">ü§ñ Bot Giao D·ªãch ·∫¢o</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 15px;">
                            T·∫°o giao d·ªãch n·∫°p/r√∫t ti·ªÅn ·∫£o ƒë·ªÉ tƒÉng t√≠nh ch√¢n th·ª±c
                        </p>
                        <div class="bot-toggle">
                            <span id="withdraw-bot-status">ƒêang t·∫Øt</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="withdraw-bot-toggle" onchange="toggleBot('withdraw')">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div style="margin-top: 15px; font-size: 12px; color: var(--text-secondary);">
                            <div>üìä ƒê√£ t·∫°o: <span id="withdraw-bot-count">0</span> giao d·ªãch</div>
                            <div>‚è±Ô∏è L·∫ßn c·∫≠p nh·∫≠t: <span id="withdraw-bot-update">Ch∆∞a c√≥</span></div>
                        </div>
                    </div>
                    
                    <div class="bot-card glass">
                        <h4 style="margin-bottom: 10px;">üéØ Bot Nhi·ªám V·ª•</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 15px;">
                            T·ª± ƒë·ªông ho√†n th√†nh nhi·ªám v·ª• ·∫£o cho ng∆∞·ªùi d√πng
                        </p>
                        <div class="bot-toggle">
                            <span id="task-bot-status">ƒêang t·∫Øt</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="task-bot-toggle" onchange="toggleBot('task')">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div style="margin-top: 15px; font-size: 12px; color: var(--text-secondary);">
                            <div>üìä ƒê√£ t·∫°o: <span id="task-bot-count">0</span> nhi·ªám v·ª•</div>
                            <div>‚è±Ô∏è L·∫ßn c·∫≠p nh·∫≠t: <span id="task-bot-update">Ch∆∞a c√≥</span></div>
                        </div>
                    </div>
                    
                    <div class="bot-card glass">
                        <h4 style="margin-bottom: 10px;">üì¢ Bot Th√¥ng B√°o</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 15px;">
                            G·ª≠i th√¥ng b√°o th√†nh c√¥ng v√† banner ƒë·ªông
                        </p>
                        <div class="bot-toggle">
                            <span id="notification-bot-status">ƒêang t·∫Øt</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="notification-bot-toggle" onchange="toggleBot('notification')">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div style="margin-top: 15px; font-size: 12px; color: var(--text-secondary);">
                            <div>üìä ƒê√£ g·ª≠i: <span id="notification-bot-count">0</span> th√¥ng b√°o</div>
                            <div>‚è±Ô∏è L·∫ßn c·∫≠p nh·∫≠t: <span id="notification-bot-update">Ch∆∞a c√≥</span></div>
                        </div>
                    </div>
                </div>
                
                <!-- Preview Section -->
                <div class="glass" style="padding: 20px; margin-top: 20px;">
                    <h4 style="margin-bottom: 15px;">üëÅÔ∏è Xem tr∆∞·ªõc tr√™n trang ch·ªß</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                        <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px;">
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">Banner</div>
                            <div style="display: flex; gap: 10px;">
                                <div style="width: 8px; height: 8px; background: var(--secondary); border-radius: 50%;"></div>
                                <div style="width: 8px; height: 8px; background: rgba(255,255,255,0.3); border-radius: 50%;"></div>
                                <div style="width: 8px; height: 8px; background: rgba(255,255,255,0.3); border-radius: 50%;"></div>
                            </div>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px;">
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">Marquee</div>
                            <div style="white-space: nowrap; overflow: hidden; width: 100%;">
                                <div style="display: inline-block; animation: marqueePreview 10s linear infinite;">
                                    üéâ Nguy·ªÖn VƒÉn A ƒë√£ n·∫°p 500,000 VNƒê ‚Ä¢ ‚úÖ Tr·∫ßn Th·ªã B ho√†n th√†nh Shopee +1,500 VNƒê ‚Ä¢ üí∞ L√™ VƒÉn C ƒë√£ r√∫t 2,000,000 VNƒê
                                </div>
                            </div>
                            <style>
                                @keyframes marqueePreview {
                                    0% { transform: translateX(100%); }
                                    100% { transform: translateX(-100%); }
                                }
                            </style>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px;">
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">Giao d·ªãch ·∫£o</div>
                            <div style="font-size: 11px;">
                                <div>üë§ Ng∆∞·ªùi d√πng ·∫£o: <span id="preview-user-count">15</span></div>
                                <div>üìà T·ªïng giao d·ªãch: <span id="preview-transaction-count">0</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Bot Logs -->
                <div class="glass" style="padding: 20px; margin-top: 20px;">
                    <h4 style="margin-bottom: 15px;">üìù Nh·∫≠t k√Ω Bot</h4>
                    <div style="max-height: 200px; overflow-y: auto; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px;">
                        <div id="bot-logs">
                            <!-- Bot logs will be added here -->
                        </div>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="clearBotLogs()" style="margin-top: 10px;">
                        <i class="fas fa-trash"></i> X√≥a nh·∫≠t k√Ω
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Account -->
        <div id="admin-account-tab" class="admin-content">
            <div class="glass" style="padding: 20px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px;">T·∫°o t√†i kho·∫£n Admin</h3>
                <div class="notification-form">
                    <div class="form-group">
                        <label for="new-admin-username">T√™n ƒëƒÉng nh·∫≠p</label>
                        <input type="text" id="new-admin-username" class="form-control" placeholder="Nh·∫≠p t√™n admin">
                    </div>
                    <div class="form-group">
                        <label for="new-admin-password">M·∫≠t kh·∫©u</label>
                        <input type="password" id="new-admin-password" class="form-control" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                    </div>
                    <div class="form-group">
                        <label for="new-admin-confirm">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                        <input type="password" id="new-admin-confirm" class="form-control" placeholder="X√°c nh·∫≠n m·∫≠t kh·∫©u">
                    </div>
                    <button class="btn btn-success" onclick="createAdminAccount()">
                        <i class="fas fa-user-plus"></i> T·∫°o t√†i kho·∫£n Admin
                    </button>
                </div>
            </div>

            <div class="glass" style="padding: 20px;">
                <h3 style="margin-bottom: 15px;">Danh s√°ch Admin</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>T√™n ƒëƒÉng nh·∫≠p</th>
                                <th>Ng√†y t·∫°o</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody id="admin-list">
                            <!-- Admin list will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- User Detail Modal -->
    <div id="user-detail-modal" class="modal">
        <div class="modal-content glass">
            <div class="modal-header">
                <h3>Chi ti·∫øt ng∆∞·ªùi d√πng</h3>
                <button class="close-modal" onclick="closeUserModal()">&times;</button>
            </div>
            <div class="user-detail">
                <!-- User details will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Admin data
        let currentAdmin = null;
        let botStatus = {
            withdraw: false,
            task: false,
            notification: false
        };

        // Bot settings
        let botSettings = {
            frequency: 15, // gi√¢y
            transactionCount: 100,
            maxAmount: 10000000,
            logs: []
        };

        // Bot statistics
        let botStats = {
            withdraw: { count: 0, lastUpdate: null },
            task: { count: 0, lastUpdate: null },
            notification: { count: 0, lastUpdate: null }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const savedAdmin = localStorage.getItem('currentAdmin');
            if (savedAdmin) {
                try {
                    currentAdmin = JSON.parse(savedAdmin);
                    const savedBots = localStorage.getItem('botStatus');
                    if (savedBots) {
                        botStatus = JSON.parse(savedBots);
                    }
                    showAdminPanel();
                } catch (e) {
                    console.error('Error loading admin data:', e);
                }
            }
        });

        // Admin login - Call API backend
        async function adminLogin() {
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;
            
            if (!username || !password) {
                alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin ƒëƒÉng nh·∫≠p');
                return;
            }
            
            try {
                const response = await fetch('/api/auth/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: username,
                        password: password
                    })
                });

                const data = await response.json();

                if (data.success) {
                    currentAdmin = data.admin;
                    localStorage.setItem('currentAdmin', JSON.stringify(currentAdmin));
                    localStorage.setItem('adminToken', data.token);
                    showAdminPanel();
                } else {
                    alert('‚ùå ' + (data.error || 'Sai t√™n ƒëƒÉng nh·∫≠p ho·∫∑c m·∫≠t kh·∫©u'));
                }
            } catch (error) {
                console.error('Admin login error:', error);
                alert('‚ùå L·ªói k·∫øt n·ªëi: ' + error.message);
            }
        }

        // Show admin panel
        function showAdminPanel() {
            document.querySelector('.login-container').style.display = 'none';
            document.querySelector('.admin-container').style.display = 'block';
            
            // Load bot settings
            loadBotSettings();
            
            // Update bot status display
            updateBotStatus();
            
            // Show dashboard
            showAdminTab('dashboard');
        }

        // Show admin tab
        function showAdminTab(tab) {
            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Hide all tabs
            document.querySelectorAll('.admin-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`${tab}-tab`).classList.add('active');
            
            // Load tab data
            switch(tab) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'deposits':
                    loadDeposits();
                    break;
                case 'withdraws':
                    loadWithdraws();
                    break;
                case 'users':
                    loadUsers();
                    break;
                case 'notifications':
                    loadNotifications();
                    break;
                case 'admin-account':
                    loadAdminList();
                    break;
            }
        }

        // Load bot settings
        function loadBotSettings() {
            const savedSettings = JSON.parse(localStorage.getItem('botSettings'));
            const savedStats = JSON.parse(localStorage.getItem('botStats'));
            
            if (savedSettings) {
                botSettings = { ...botSettings, ...savedSettings };
            }
            
            if (savedStats) {
                botStats = { ...botStats, ...savedStats };
            }
            
            // Update UI
            document.getElementById('bot-frequency').value = botSettings.frequency;
            document.getElementById('frequency-value').textContent = `${botSettings.frequency} gi√¢y`;
            
            document.getElementById('bot-transaction-count').value = botSettings.transactionCount;
            document.getElementById('transaction-count-value').textContent = `${botSettings.transactionCount} giao d·ªãch`;
            
            document.getElementById('bot-max-amount').value = botSettings.maxAmount;
            
            // Update bot status displays
            updateBotStatsDisplay();
            
            // Load logs
            loadBotLogs();
            
            // Update preview
            updateBotPreview();
        }

        // Update bot status display
        function updateBotStatus() {
            document.getElementById('withdraw-bot-status').textContent = 
                botStatus.withdraw ? 'ƒêang b·∫≠t' : 'ƒêang t·∫Øt';
            document.getElementById('withdraw-bot-toggle').checked = botStatus.withdraw;
            
            document.getElementById('task-bot-status').textContent = 
                botStatus.task ? 'ƒêang b·∫≠t' : 'ƒêang t·∫Øt';
            document.getElementById('task-bot-toggle').checked = botStatus.task;
            
            document.getElementById('notification-bot-status').textContent = 
                botStatus.notification ? 'ƒêang b·∫≠t' : 'ƒêang t·∫Øt';
            document.getElementById('notification-bot-toggle').checked = botStatus.notification;
        }

        // Update bot stats display
        function updateBotStatsDisplay() {
            document.getElementById('withdraw-bot-count').textContent = botStats.withdraw.count;
            document.getElementById('task-bot-count').textContent = botStats.task.count;
            document.getElementById('notification-bot-count').textContent = botStats.notification.count;
            
            document.getElementById('withdraw-bot-update').textContent = 
                botStats.withdraw.lastUpdate ? new Date(botStats.withdraw.lastUpdate).toLocaleTimeString('vi-VN') : 'Ch∆∞a c√≥';
            document.getElementById('task-bot-update').textContent = 
                botStats.task.lastUpdate ? new Date(botStats.task.lastUpdate).toLocaleTimeString('vi-VN') : 'Ch∆∞a c√≥';
            document.getElementById('notification-bot-update').textContent = 
                botStats.notification.lastUpdate ? new Date(botStats.notification.lastUpdate).toLocaleTimeString('vi-VN') : 'Ch∆∞a c√≥';
        }

        // Update bot preview
        function updateBotPreview() {
            const transactions = JSON.parse(localStorage.getItem('fakeTransactions') || '[]');
            document.getElementById('preview-transaction-count').textContent = transactions.length;
            document.getElementById('preview-user-count').textContent = 15; // Fixed 15 fake users
        }

        // Toggle bot
        function toggleBot(botType) {
            botStatus[botType] = !botStatus[botType];
            localStorage.setItem('botStatus', JSON.stringify(botStatus));
            updateBotStatus();
            
            // Update stats
            botStats[botType].count++;
            botStats[botType].lastUpdate = new Date().toISOString();
            localStorage.setItem('botStats', JSON.stringify(botStats));
            updateBotStatsDisplay();
            
            // Add log
            const action = botStatus[botType] ? 'b·∫≠t' : 't·∫Øt';
            addBotLog(`ƒê√£ ${action} bot ${botType}`, 'success');
            
            // Update preview
            updateBotPreview();
        }

        // Add bot log
        function addBotLog(message, type = 'info') {
            const log = {
                id: Date.now(),
                message: message,
                type: type,
                time: new Date().toISOString()
            };
            
            botSettings.logs.unshift(log);
            
            // Gi·ªõi h·∫°n 50 log g·∫ßn nh·∫•t
            if (botSettings.logs.length > 50) {
                botSettings.logs = botSettings.logs.slice(0, 50);
            }
            
            localStorage.setItem('botSettings', JSON.stringify(botSettings));
            
            // Display log
            displayBotLog(log);
        }

        // Display bot log
        function displayBotLog(log) {
            const logsContainer = document.getElementById('bot-logs');
            const logElement = document.createElement('div');
            logElement.className = 'log-item';
            logElement.style.cssText = `
                padding: 8px;
                margin-bottom: 5px;
                background: rgba(255,255,255,0.05);
                border-radius: 5px;
                font-size: 12px;
                border-left: 3px solid ${log.type === 'success' ? '#10b981' : log.type === 'error' ? '#ef4444' : '#3b82f6'};
            `;
            
            const time = new Date(log.time).toLocaleTimeString('vi-VN');
            logElement.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>${log.message}</span>
                    <span style="color: var(--text-secondary); font-size: 10px;">${time}</span>
                </div>
            `;
            
            logsContainer.insertBefore(logElement, logsContainer.firstChild);
        }

        // Load bot logs
        function loadBotLogs() {
            const logsContainer = document.getElementById('bot-logs');
            logsContainer.innerHTML = '';
            
            botSettings.logs.forEach(log => {
                displayBotLog(log);
            });
            
            if (botSettings.logs.length === 0) {
                logsContainer.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 20px;">Ch∆∞a c√≥ nh·∫≠t k√Ω</div>';
            }
        }

        // Clear bot logs
        function clearBotLogs() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t·∫•t c·∫£ nh·∫≠t k√Ω bot?')) {
                botSettings.logs = [];
                localStorage.setItem('botSettings', JSON.stringify(botSettings));
                document.getElementById('bot-logs').innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 20px;">Ch∆∞a c√≥ nh·∫≠t k√Ω</div>';
            }
        }

        // Load dashboard
        function loadDashboard() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const deposits = JSON.parse(localStorage.getItem('deposits') || '[]');
            const withdraws = JSON.parse(localStorage.getItem('withdraws') || '[]');
            
            // Total system balance
            let totalDeposited = 0;
            users.forEach(user => {
                const userData = JSON.parse(localStorage.getItem(`userData_${user.id}`) || '{}');
                totalDeposited += userData.deposited || 0;
            });
            
            // Pending requests
            const pendingDeposits = deposits.filter(d => d.status === 'pending').length;
            const pendingWithdraws = withdraws.filter(w => w.status === 'pending').length;
            
            // Today's revenue
            const today = new Date().toDateString();
            const todayDeposits = deposits.filter(d => {
                const depositDate = new Date(d.createdAt).toDateString();
                return depositDate === today && d.status === 'completed';
            });
            const todayRevenue = todayDeposits.reduce((sum, d) => sum + (d.amount || 0), 0);
            
            // Update stats
            document.getElementById('total-system-balance').textContent = formatCurrency(totalDeposited);
            document.getElementById('total-users').textContent = users.length;
            document.getElementById('pending-requests').textContent = pendingDeposits + pendingWithdraws;
            document.getElementById('today-revenue').textContent = formatCurrency(todayRevenue);
            
            // Load recent activity
            loadRecentActivity();
        }

        // Load recent activity
        function loadRecentActivity() {
            const deposits = JSON.parse(localStorage.getItem('deposits') || '[]');
            const withdraws = JSON.parse(localStorage.getItem('withdraws') || '[]');
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Combine and sort activities
            let activities = [
                ...deposits.map(d => ({ ...d, type: 'deposit', username: getUserName(d.userId) })),
                ...withdraws.map(w => ({ ...w, type: 'withdraw', username: getUserName(w.userId) }))
            ];
            
            activities.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            activities = activities.slice(0, 10);
            
            const tbody = document.getElementById('recent-activity');
            tbody.innerHTML = '';
            
            activities.forEach(activity => {
                const row = document.createElement('tr');
                const date = new Date(activity.createdAt);
                const statusClass = activity.status === 'completed' ? 'status-success' : 
                                   activity.status === 'pending' ? 'status-pending' : 'status-failed';
                const statusText = activity.status === 'completed' ? 'Th√†nh c√¥ng' : 
                                  activity.status === 'pending' ? 'ƒêang ch·ªù' : 'ƒê√£ hu·ª∑';
                const typeText = activity.type === 'deposit' ? 'N·∫°p ti·ªÅn' : 'R√∫t ti·ªÅn';
                
                row.innerHTML = `
                    <td>${date.toLocaleDateString('vi-VN')} ${date.toLocaleTimeString('vi-VN')}</td>
                    <td>${activity.username || 'N/A'}</td>
                    <td>${typeText}</td>
                    <td>${formatCurrency(activity.amount)}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                `;
                tbody.appendChild(row);
            });
            
            if (activities.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Ch∆∞a c√≥ ho·∫°t ƒë·ªông n√†o
                        </td>
                    </tr>
                `;
            }
        }

        // Get user name by ID
        function getUserName(userId) {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const user = users.find(u => u.id === userId);
            return user ? user.username : 'N/A';
        }

        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('vi-VN', { 
                style: 'currency', 
                currency: 'VND' 
            }).format(amount || 0);
        }

        // Load deposits
        function loadDeposits() {
            const deposits = JSON.parse(localStorage.getItem('deposits') || '[]');
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            const tbody = document.getElementById('deposits-list');
            tbody.innerHTML = '';
            
            deposits.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).forEach(deposit => {
                const row = document.createElement('tr');
                const date = new Date(deposit.createdAt);
                const user = users.find(u => u.id === deposit.userId);
                const statusClass = deposit.status === 'completed' ? 'status-success' : 
                                   deposit.status === 'pending' ? 'status-pending' : 'status-failed';
                const statusText = deposit.status === 'completed' ? 'Th√†nh c√¥ng' : 
                                  deposit.status === 'pending' ? 'ƒêang ch·ªù' : 'ƒê√£ hu·ª∑';
                
                row.innerHTML = `
                    <td>${date.toLocaleDateString('vi-VN')} ${date.toLocaleTimeString('vi-VN')}</td>
                    <td>${user ? user.username : 'N/A'}</td>
                    <td>${formatCurrency(deposit.amount)}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td class="action-buttons">
                        ${deposit.status === 'pending' ? `
                            <button class="btn btn-success btn-sm" onclick="approveDeposit('${deposit.id}')">
                                <i class="fas fa-check"></i> Duy·ªát
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="rejectDeposit('${deposit.id}')">
                                <i class="fas fa-times"></i> T·ª´ ch·ªëi
                            </button>
                        ` : ''}
                        <button class="btn btn-warning btn-sm" onclick="viewUserDetail('${deposit.userId}')">
                            <i class="fas fa-eye"></i> Xem
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (deposits.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Ch∆∞a c√≥ giao d·ªãch n·∫°p ti·ªÅn n√†o
                        </td>
                    </tr>
                `;
            }
        }

        // Approve deposit
        function approveDeposit(depositId) {
            const deposits = JSON.parse(localStorage.getItem('deposits') || '[]');
            const deposit = deposits.find(d => d.id === depositId);
            
            if (deposit) {
                deposit.status = 'completed';
                deposit.approvedAt = new Date().toISOString();
                deposit.approvedBy = currentAdmin.username;
                
                // Update user balance
                const userData = JSON.parse(localStorage.getItem(`userData_${deposit.userId}`) || '{}');
                userData.deposited = (userData.deposited || 0) + deposit.amount;
                userData.balance = (userData.balance || 0) + deposit.amount;
                localStorage.setItem(`userData_${deposit.userId}`, JSON.stringify(userData));
                
                localStorage.setItem('deposits', JSON.stringify(deposits));
                loadDeposits();
                loadDashboard();
                
                alert('ƒê√£ duy·ªát ƒë∆°n n·∫°p ti·ªÅn th√†nh c√¥ng!');
                addBotLog(`ƒê√£ duy·ªát ƒë∆°n n·∫°p ti·ªÅn ${formatCurrency(deposit.amount)} cho ng∆∞·ªùi d√πng`, 'success');
            }
        }

        // Reject deposit
        function rejectDeposit(depositId) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën t·ª´ ch·ªëi ƒë∆°n n·∫°p ti·ªÅn n√†y?')) {
                const deposits = JSON.parse(localStorage.getItem('deposits') || '[]');
                const deposit = deposits.find(d => d.id === depositId);
                
                if (deposit) {
                    deposit.status = 'failed';
                    deposit.rejectedAt = new Date().toISOString();
                    deposit.rejectedBy = currentAdmin.username;
                    
                    localStorage.setItem('deposits', JSON.stringify(deposits));
                    loadDeposits();
                    loadDashboard();
                    
                    alert('ƒê√£ t·ª´ ch·ªëi ƒë∆°n n·∫°p ti·ªÅn!');
                    addBotLog(`ƒê√£ t·ª´ ch·ªëi ƒë∆°n n·∫°p ti·ªÅn ${formatCurrency(deposit.amount)}`, 'error');
                }
            }
        }

        // Load withdraws
        function loadWithdraws() {
            const withdraws = JSON.parse(localStorage.getItem('withdraws') || '[]');
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            const tbody = document.getElementById('withdraws-list');
            tbody.innerHTML = '';
            
            withdraws.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).forEach(withdraw => {
                const row = document.createElement('tr');
                const date = new Date(withdraw.createdAt);
                const user = users.find(u => u.id === withdraw.userId);
                const statusClass = withdraw.status === 'completed' ? 'status-success' : 
                                   withdraw.status === 'pending' ? 'status-pending' : 'status-failed';
                const statusText = withdraw.status === 'completed' ? 'Th√†nh c√¥ng' : 
                                  withdraw.status === 'pending' ? 'ƒêang ch·ªù' : 'ƒê√£ hu·ª∑';
                
                row.innerHTML = `
                    <td>${date.toLocaleDateString('vi-VN')} ${date.toLocaleTimeString('vi-VN')}</td>
                    <td>${user ? user.username : 'N/A'}</td>
                    <td>${formatCurrency(withdraw.amount)}</td>
                    <td>${withdraw.bankName} - ${withdraw.accountNumber}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td class="action-buttons">
                        ${withdraw.status === 'pending' ? `
                            <button class="btn btn-success btn-sm" onclick="approveWithdraw('${withdraw.id}')">
                                <i class="fas fa-check"></i> Duy·ªát
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="rejectWithdraw('${withdraw.id}')">
                                <i class="fas fa-times"></i> T·ª´ ch·ªëi
                            </button>
                        ` : ''}
                        <button class="btn btn-warning btn-sm" onclick="viewUserDetail('${withdraw.userId}')">
                            <i class="fas fa-eye"></i> Xem
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (withdraws.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Ch∆∞a c√≥ giao d·ªãch r√∫t ti·ªÅn n√†o
                        </td>
                    </tr>
                `;
            }
        }

        // Approve withdraw
        function approveWithdraw(withdrawId) {
            const withdraws = JSON.parse(localStorage.getItem('withdraws') || '[]');
            const withdraw = withdraws.find(w => w.id === withdrawId);
            
            if (withdraw) {
                withdraw.status = 'completed';
                withdraw.approvedAt = new Date().toISOString();
                withdraw.approvedBy = currentAdmin.username;
                
                localStorage.setItem('withdraws', JSON.stringify(withdraws));
                loadWithdraws();
                loadDashboard();
                
                alert('ƒê√£ duy·ªát ƒë∆°n r√∫t ti·ªÅn th√†nh c√¥ng!');
                addBotLog(`ƒê√£ duy·ªát ƒë∆°n r√∫t ti·ªÅn ${formatCurrency(withdraw.amount)}`, 'success');
            }
        }

        // Reject withdraw
        function rejectWithdraw(withdrawId) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën t·ª´ ch·ªëi ƒë∆°n r√∫t ti·ªÅn n√†y?')) {
                const withdraws = JSON.parse(localStorage.getItem('withdraws') || '[]');
                const withdraw = withdraws.find(w => w.id === withdrawId);
                
                if (withdraw) {
                    withdraw.status = 'failed';
                    withdraw.rejectedAt = new Date().toISOString();
                    withdraw.rejectedBy = currentAdmin.username;
                    
                    // Refund user balance
                    const userData = JSON.parse(localStorage.getItem(`userData_${withdraw.userId}`) || '{}');
                    userData.balance = (userData.balance || 0) + withdraw.amount;
                    localStorage.setItem(`userData_${withdraw.userId}`, JSON.stringify(userData));
                    
                    localStorage.setItem('withdraws', JSON.stringify(withdraws));
                    loadWithdraws();
                    loadDashboard();
                    
                    alert('ƒê√£ t·ª´ ch·ªëi ƒë∆°n r√∫t ti·ªÅn! Ti·ªÅn ƒë√£ ƒë∆∞·ª£c ho√†n l·∫°i cho ng∆∞·ªùi d√πng.');
                    addBotLog(`ƒê√£ t·ª´ ch·ªëi ƒë∆°n r√∫t ti·ªÅn ${formatCurrency(withdraw.amount)}`, 'error');
                }
            }
        }

        // Load users
        function loadUsers() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            const tbody = document.getElementById('users-list');
            tbody.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                const date = new Date(user.created);
                const userData = JSON.parse(localStorage.getItem(`userData_${user.id}`) || '{}');
                const totalBalance = (userData.balance || 0) + (userData.commission || 0);
                
                row.innerHTML = `
                    <td>${user.id.substring(0, 8)}...</td>
                    <td>${user.username}</td>
                    <td>${date.toLocaleDateString('vi-VN')}</td>
                    <td>${formatCurrency(totalBalance)}</td>
                    <td>${formatCurrency(userData.deposited || 0)}</td>
                    <td class="action-buttons">
                        <button class="btn btn-warning btn-sm" onclick="viewUserDetail('${user.id}')">
                            <i class="fas fa-eye"></i> Chi ti·∫øt
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteUser('${user.id}')">
                            <i class="fas fa-trash"></i> Xo√°
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (users.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Ch∆∞a c√≥ ng∆∞·ªùi d√πng n√†o
                        </td>
                    </tr>
                `;
            }
        }

        // Search users
        function searchUsers() {
            const searchTerm = document.getElementById('user-search').value.toLowerCase();
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            const tbody = document.getElementById('users-list');
            tbody.innerHTML = '';
            
            const filteredUsers = users.filter(user => 
                user.username.toLowerCase().includes(searchTerm) || 
                user.id.includes(searchTerm)
            );
            
            filteredUsers.forEach(user => {
                const row = document.createElement('tr');
                const date = new Date(user.created);
                const userData = JSON.parse(localStorage.getItem(`userData_${user.id}`) || '{}');
                const totalBalance = (userData.balance || 0) + (userData.commission || 0);
                
                row.innerHTML = `
                    <td>${user.id.substring(0, 8)}...</td>
                    <td>${user.username}</td>
                    <td>${date.toLocaleDateString('vi-VN')}</td>
                    <td>${formatCurrency(totalBalance)}</td>
                    <td>${formatCurrency(userData.deposited || 0)}</td>
                    <td class="action-buttons">
                        <button class="btn btn-warning btn-sm" onclick="viewUserDetail('${user.id}')">
                            <i class="fas fa-eye"></i> Chi ti·∫øt
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteUser('${user.id}')">
                            <i class="fas fa-trash"></i> Xo√°
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (filteredUsers.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi d√πng
                        </td>
                    </tr>
                `;
            }
        }

        // View user detail
        function viewUserDetail(userId) {
            const user = JSON.parse(localStorage.getItem('users') || '[]').find(u => u.id === userId);
            const userData = JSON.parse(localStorage.getItem(`userData_${userId}`) || '{}');
            
            if (user) {
                const detailDiv = document.querySelector('.user-detail');
                detailDiv.innerHTML = `
                    <div class="detail-row">
                        <span style="color: var(--text-secondary);">ID:</span>
                        <span>${user.id}</span>
                    </div>
                    <div class="detail-row">
                        <span style="color: var(--text-secondary);">T√™n ƒëƒÉng nh·∫≠p:</span>
                        <span>${user.username}</span>
                    </div>
                    <div class="detail-row">
                        <span style="color: var(--text-secondary);">Ng√†y t·∫°o:</span>
                        <span>${new Date(user.created).toLocaleDateString('vi-VN')}</span>
                    </div>
                    <div class="detail-row">
                        <span style="color: var(--text-secondary);">S·ªë d∆∞ n·∫°p:</span>
                        <span>${formatCurrency(userData.balance || 0)}</span>
                    </div>
                    <div class="detail-row">
                        <span style="color: var(--text-secondary);">Hoa h·ªìng:</span>
                        <span>${formatCurrency(userData.commission || 0)}</span>
                    </div>
                    <div class="detail-row">
                        <span style="color: var(--text-secondary);">T·ªïng ƒë√£ n·∫°p:</span>
                        <span>${formatCurrency(userData.deposited || 0)}</span>
                    </div>
                    <div class="detail-row">
                        <span style="color: var(--text-secondary);">C·∫•p ƒë·ªô:</span>
                        <span>${userData.level || 1}</span>
                    </div>
                    <div class="detail-row">
                        <span style="color: var(--text-secondary);">Nhi·ªám v·ª• ƒë√£ l√†m:</span>
                        <span>${userData.tasksCompleted || 0}</span>
                    </div>
                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="adjustUserBalance('${userId}')" style="width: 100%;">
                            <i class="fas fa-edit"></i> ƒêi·ªÅu ch·ªânh s·ªë d∆∞
                        </button>
                    </div>
                `;
                
                document.getElementById('user-detail-modal').classList.add('active');
            }
        }

        // Adjust user balance
        function adjustUserBalance(userId) {
            const amount = prompt('Nh·∫≠p s·ªë ti·ªÅn mu·ªën ƒëi·ªÅu ch·ªânh (d∆∞∆°ng ƒë·ªÉ c·ªông, √¢m ƒë·ªÉ tr·ª´):');
            if (amount === null) return;
            
            const numAmount = parseFloat(amount);
            if (isNaN(numAmount)) {
                alert('S·ªë ti·ªÅn kh√¥ng h·ª£p l·ªá');
                return;
            }
            
            const userData = JSON.parse(localStorage.getItem(`userData_${userId}`) || '{}');
            userData.balance = (userData.balance || 0) + numAmount;
            
            if (userData.balance < 0) {
                userData.balance = 0;
                alert('S·ªë d∆∞ kh√¥ng th·ªÉ √¢m. ƒê√£ ƒë·∫∑t v·ªÅ 0.');
            }
            
            localStorage.setItem(`userData_${userId}`, JSON.stringify(userData));
            
            viewUserDetail(userId);
            loadUsers();
            loadDashboard();
            
            alert('ƒê√£ ƒëi·ªÅu ch·ªânh s·ªë d∆∞ th√†nh c√¥ng!');
            addBotLog(`ƒê√£ ƒëi·ªÅu ch·ªânh s·ªë d∆∞ ${numAmount > 0 ? '+' : ''}${formatCurrency(numAmount)} cho ng∆∞·ªùi d√πng`, 'success');
        }

        // Delete user
        function deleteUser(userId) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xo√° ng∆∞·ªùi d√πng n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.')) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const filteredUsers = users.filter(u => u.id !== userId);
                
                localStorage.setItem('users', JSON.stringify(filteredUsers));
                localStorage.removeItem(`userData_${userId}`);
                
                loadUsers();
                loadDashboard();
                
                alert('ƒê√£ xo√° ng∆∞·ªùi d√πng th√†nh c√¥ng!');
                addBotLog(`ƒê√£ xo√° ng∆∞·ªùi d√πng ID: ${userId.substring(0, 8)}`, 'error');
            }
        }

        // Close user modal
        function closeUserModal() {
            document.getElementById('user-detail-modal').classList.remove('active');
        }

        // Send notification
        function sendNotification() {
            const title = document.getElementById('notification-title').value;
            const content = document.getElementById('notification-content').value;
            
            if (!title || !content) {
                alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß ti√™u ƒë·ªÅ v√† n·ªôi dung th√¥ng b√°o');
                return;
            }
            
            const notification = {
                id: Date.now().toString(),
                title: title,
                content: content,
                createdBy: currentAdmin.username,
                createdAt: new Date().toISOString()
            };
            
            const notifications = JSON.parse(localStorage.getItem('notifications') || '[]');
            notifications.push(notification);
            localStorage.setItem('notifications', JSON.stringify(notifications));
            
            document.getElementById('notification-title').value = '';
            document.getElementById('notification-content').value = '';
            
            loadNotifications();
            alert('ƒê√£ g·ª≠i th√¥ng b√°o th√†nh c√¥ng!');
            addBotLog(`ƒê√£ g·ª≠i th√¥ng b√°o: ${title}`, 'success');
        }

        // Load notifications
        function loadNotifications() {
            const notifications = JSON.parse(localStorage.getItem('notifications') || '[]');
            
            const tbody = document.getElementById('notifications-list');
            tbody.innerHTML = '';
            
            notifications.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)).forEach(notification => {
                const row = document.createElement('tr');
                const date = new Date(notification.createdAt);
                
                row.innerHTML = `
                    <td>${date.toLocaleDateString('vi-VN')} ${date.toLocaleTimeString('vi-VN')}</td>
                    <td>${notification.title}</td>
                    <td>${notification.content.substring(0, 100)}${notification.content.length > 100 ? '...' : ''}</td>
                    <td>
                        <button class="btn btn-danger btn-sm" onclick="deleteNotification('${notification.id}')">
                            <i class="fas fa-trash"></i> Xo√°
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (notifications.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Ch∆∞a c√≥ th√¥ng b√°o n√†o
                        </td>
                    </tr>
                `;
            }
        }

        // Delete notification
        function deleteNotification(notificationId) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xo√° th√¥ng b√°o n√†y?')) {
                const notifications = JSON.parse(localStorage.getItem('notifications') || '[]');
                const filteredNotifications = notifications.filter(n => n.id !== notificationId);
                
                localStorage.setItem('notifications', JSON.stringify(filteredNotifications));
                loadNotifications();
                
                alert('ƒê√£ xo√° th√¥ng b√°o th√†nh c√¥ng!');
                addBotLog('ƒê√£ xo√° th√¥ng b√°o', 'error');
            }
        }

        // Create admin account
        function createAdminAccount() {
            const username = document.getElementById('new-admin-username').value;
            const password = document.getElementById('new-admin-password').value;
            const confirm = document.getElementById('new-admin-confirm').value;
            
            if (!username || !password || !confirm) {
                alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin');
                return;
            }
            
            if (password !== confirm) {
                alert('M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp');
                return;
            }
            
            if (password.length < 6) {
                alert('M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±');
                return;
            }
            
            const admins = JSON.parse(localStorage.getItem('admins') || '[]');
            if (admins.some(a => a.username === username)) {
                alert('T√™n ƒëƒÉng nh·∫≠p ƒë√£ t·ªìn t·∫°i');
                return;
            }
            
            const newAdmin = {
                id: Date.now().toString(),
                username: username,
                password: password,
                created: new Date().toISOString(),
                createdBy: currentAdmin.username
            };
            
            admins.push(newAdmin);
            localStorage.setItem('admins', JSON.stringify(admins));
            
            document.getElementById('new-admin-username').value = '';
            document.getElementById('new-admin-password').value = '';
            document.getElementById('new-admin-confirm').value = '';
            
            loadAdminList();
            alert('ƒê√£ t·∫°o t√†i kho·∫£n Admin th√†nh c√¥ng!');
            addBotLog(`ƒê√£ t·∫°o t√†i kho·∫£n admin m·ªõi: ${username}`, 'success');
        }

        // Load admin list
        function loadAdminList() {
            const admins = JSON.parse(localStorage.getItem('admins') || '[]');
            
            const tbody = document.getElementById('admin-list');
            tbody.innerHTML = '';
            
            admins.forEach(admin => {
                const row = document.createElement('tr');
                const date = new Date(admin.created);
                
                row.innerHTML = `
                    <td>${admin.username}</td>
                    <td>${date.toLocaleDateString('vi-VN')}</td>
                    <td>
                        ${admin.username !== 'admin' ? `
                            <button class="btn btn-danger btn-sm" onclick="deleteAdmin('${admin.id}')">
                                <i class="fas fa-trash"></i> Xo√°
                            </button>
                        ` : 'Admin ch√≠nh'}
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Delete admin
        function deleteAdmin(adminId) {
            if (adminId === '1') {
                alert('Kh√¥ng th·ªÉ xo√° admin ch√≠nh!');
                return;
            }
            
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xo√° admin n√†y?')) {
                const admins = JSON.parse(localStorage.getItem('admins') || '[]');
                const filteredAdmins = admins.filter(a => a.id !== adminId);
                
                localStorage.setItem('admins', JSON.stringify(filteredAdmins));
                loadAdminList();
                
                alert('ƒê√£ xo√° admin th√†nh c√¥ng!');
                addBotLog('ƒê√£ xo√° t√†i kho·∫£n admin', 'error');
            }
        }

        // Admin logout
        function adminLogout() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?')) {
                currentAdmin = null;
                localStorage.removeItem('currentAdmin');
                document.querySelector('.admin-container').style.display = 'none';
                document.querySelector('.login-container').style.display = 'flex';
            }
        }

        // Event listeners cho settings
        document.getElementById('bot-frequency').addEventListener('input', function(e) {
            botSettings.frequency = parseInt(e.target.value);
            document.getElementById('frequency-value').textContent = `${botSettings.frequency} gi√¢y`;
            localStorage.setItem('botSettings', JSON.stringify(botSettings));
            addBotLog(`ƒê√£ thay ƒë·ªïi t·∫ßn su·∫•t bot: ${botSettings.frequency} gi√¢y`);
        });
        
        document.getElementById('bot-transaction-count').addEventListener('input', function(e) {
            botSettings.transactionCount = parseInt(e.target.value);
            document.getElementById('transaction-count-value').textContent = `${botSettings.transactionCount} giao d·ªãch`;
            localStorage.setItem('botSettings', JSON.stringify(botSettings));
            addBotLog(`ƒê√£ thay ƒë·ªïi s·ªë giao d·ªãch/ng√†y: ${botSettings.transactionCount}`);
        });
        
        document.getElementById('bot-max-amount').addEventListener('change', function(e) {
            botSettings.maxAmount = parseInt(e.target.value);
            localStorage.setItem('botSettings', JSON.stringify(botSettings));
            addBotLog(`ƒê√£ thay ƒë·ªïi s·ªë ti·ªÅn t·ªëi ƒëa: ${formatCurrency(botSettings.maxAmount)}`);
        });

        // Close modals on outside click
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.classList.remove('active');
                }
            });
        }
    </script>
</body>
</html>
